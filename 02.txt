WITH users_photo_video_rating AS (
SELECT DISTINCT
    users.first_name,
    users.last_name,
    COUNT(DISTINCT photo.id) AS photo_count,
    COUNT(Distinct video.id) AS video_count
    FROM users
        LEFT JOIN photo
            ON users.id = photo.owner_id
        LEFT JOIN video
            ON users.id = video.owner_id
GROUP BY users.id)
SELECT
    first_name,
    last_name,
    photo_count,
    video_count,
    DENSE_RANK() OVER (ORDER BY photo_count DESC) AS photo_rank,
    DENSE_RANK() OVER (ORDER BY video_count DESC) AS video_rank
        FROM users_photo_video_rating
ORDER BY photo_rank, video_rank;
